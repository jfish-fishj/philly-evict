---
title: "Quarterly Event Study: Eviction Filing Rates Around Ownership Transfers"
author: "Philly Evictions Project"
date: today
format:
  pdf:
    pdf-engine: xelatex
    documentclass: article
    geometry: margin=1in
    fontsize: 11pt
    keep-tex: true
    number-sections: true
    toc: true
    include-in-header:
      text: |
        \usepackage{booktabs}
        \usepackage{dcolumn}
        \usepackage{longtable}
        \usepackage{adjustbox}
        \usepackage{amsmath}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = FALSE,
  warning = FALSE,
  message = FALSE,
  fig.width = 10,
  fig.height = 7,
  dpi = 300,
  out.width = "100%"
)
```

```{r load-data}
suppressPackageStartupMessages({
  library(data.table)
  library(stringr)
  library(ggplot2)
  library(knitr)
  library(kableExtra)
})
qmd_path <- knitr::current_input(dir = TRUE)
proj_root <- normalizePath(file.path(dirname(qmd_path), ".."), winslash = "/", mustWork = FALSE)
source(file.path(proj_root, "r", "config.R"))
source(file.path(proj_root, "r", "helper-functions.R"))
old_wd <- getwd()
setwd(proj_root)
on.exit(setwd(old_wd), add = TRUE)
cfg <- read_config(file.path(proj_root, "config.yml"))

out_dir <- file.path(proj_root, "output", "transfer_evictions")
fig_dir <- file.path(proj_root, "output", "figs")

# Load all quarterly results
baseline_coefs <- fread(file.path(out_dir, "transfer_evictions_quarterly_baseline_coefs.csv"))
size_coefs     <- fread(file.path(out_dir, "transfer_evictions_quarterly_size_coefs.csv"))
buyer_coefs    <- fread(file.path(out_dir, "transfer_evictions_quarterly_buyer_coefs.csv"))
raw_means      <- fread(file.path(out_dir, "transfer_evictions_quarterly_raw_means.csv"))
raw_means_binary <- fread(file.path(out_dir, "transfer_evictions_quarterly_raw_means_binary.csv"))

# Acquirer and portfolio — full sample
acq_coefs_path <- file.path(out_dir, "transfer_evictions_quarterly_acq_filer_coefs.csv")
acq_coefs <- if (file.exists(acq_coefs_path)) fread(acq_coefs_path) else data.table()
acq_stats <- fread(file.path(out_dir, "transfer_evictions_quarterly_acq_bin_stats.csv"))
acq_desc  <- fread(file.path(out_dir, "transfer_evictions_quarterly_acq_descriptives.csv"))

# Acquirer and portfolio — 5+ units
acq_5plus_path <- file.path(out_dir, "transfer_evictions_quarterly_acq_filer_5plus_coefs.csv")
acq_5plus_coefs <- if (file.exists(acq_5plus_path)) fread(acq_5plus_path) else data.table()

port_coefs_path <- file.path(out_dir, "transfer_evictions_quarterly_portfolio_coefs.csv")
port_coefs <- if (file.exists(port_coefs_path)) fread(port_coefs_path) else data.table()
port_5plus_path <- file.path(out_dir, "transfer_evictions_quarterly_portfolio_5plus_coefs.csv")
port_5plus_coefs <- if (file.exists(port_5plus_path)) fread(port_5plus_path) else data.table()
port_stats <- fread(file.path(out_dir, "transfer_evictions_quarterly_portfolio_bin_stats.csv"))

# Descriptives
transfer_rate <- fread(file.path(out_dir, "transfer_evictions_quarterly_transfer_rate_by_evict_class.csv"))
buyer_by_class <- fread(file.path(out_dir, "transfer_evictions_quarterly_buyer_by_prop_evict_class.csv"))
cross_tab <- fread(file.path(out_dir, "transfer_evictions_quarterly_prop_x_acq_crosstab.csv"))

# QA text for inline stats
qa_lines <- readLines(file.path(out_dir, "transfer_evictions_quarterly_qa.txt"))

# Extract key stats
med_acq_line <- qa_lines[grep("Median.*acquirers with rate", qa_lines)]
med_acq <- as.numeric(trimws(gsub(".*: ", "", med_acq_line)))
med_prop_line <- qa_lines[grep("Median.*filing_rate_eb|Median.*properties with any", qa_lines)]
med_prop <- as.numeric(trimws(gsub(".*: ", "", med_prop_line)))
```

# Motivation

The annual event study (`analyze-transfer-evictions.R`) shows a suspicious jump in filing rates from $t=-2$ to $t=-1$ (the year before transfer). Monthly analysis of raw filing dates reveals the true pattern: **filings decline in the 3--6 months before transfer and bottom out at the transfer date**, then recover afterward.

The annual binning creates artifacts because $t=-1$ (the calendar year before transfer) mixes the elevated pre-decline period with the declining period, depending on when in the year the transfer occurs.

**This quarterly event study uses exact transfer dates and day-level filing dates** to:

1. Correctly identify *when* the filing rate change occurs relative to the actual transfer
2. Distinguish the pattern by building size (the pre-transfer dip for 1-unit buildings could be vacancy/non-renewal, while multi-unit buildings would indicate an operational pattern)
3. Give cleaner identification of the post-transfer ramp-up timing

# Data Construction

## Quarterly eviction counts

Day-level eviction filing dates (`d_filing` from `evictions_clean`) are linked to parcels via the address crosswalk (`evict_address_xwalk`, restricted to unique parcel matches). Filings are aggregated to PID $\times$ quarter cells using the `YYYY-Q#` format.

## Event panel

Transfer events from `rtt_clean` use the exact `display_date` for timing. We:

1. Collapse RTT to PID-quarter level (keeping the highest-consideration transfer per quarter)
2. Expand to a quarterly event grid: $q \in \{-12, \ldots, +20\}$ (3 years before, 5 years after)
3. Map each relative quarter to a calendar quarter by adding $q \times 91$ days to the actual transfer date
4. Merge quarterly filing counts (zeros where no filings)
5. Merge annual `total_units` from `bldg_panel_blp` for rate computation
6. Compute filing rate: $\text{num\_filings\_q} / \text{total\_units}$

```{r sample-stats}
n_baseline <- baseline_coefs[spec == "full_unweighted", n[1]]
n_5plus <- baseline_coefs[spec == "5plus_unweighted", n[1]]
```

**Sample:** The baseline regression uses `r format(n_baseline, big.mark = ",")` PID $\times$ quarter observations (full sample, unweighted). The 5+ unit subsample has `r format(n_5plus, big.mark = ",")` observations.

**Pre-COVID restriction:** All filing rate outcomes are restricted to calendar quarters $\leq$ 2019Q4 (pre-COVID). The pandemic disrupted court operations and filing patterns, making post-2019 data unreliable for measuring landlord behavior.

**Standard errors** are clustered at the PID level throughout --- the building is the unit of treatment and where serial correlation in filing rates lives.

# Raw Quarterly Profile

```{r raw-profile-plot, fig.cap="Mean quarterly filing rate around ownership transfer (full sample). The pre-transfer dip at q=-1 and q=0 is clearly visible."}
knitr::include_graphics(file.path(fig_dir, "rtt_eviction_quarterly_raw_profile.png"))
```

```{r raw-binary-plot, fig.cap="Mean quarterly filing rate: 1-unit vs multi-unit buildings. The pre-transfer dip is much sharper for single-unit buildings, consistent with vacancy during sale."}
knitr::include_graphics(file.path(fig_dir, "rtt_eviction_quarterly_raw_1v_multi.png"))
```

The quarterly profile reveals a clear pattern that the annual analysis obscures:

1. **Baseline period** ($q = -12$ to $q = -6$): Filing rates are relatively stable around 0.010 per unit-quarter.
2. **Pre-transfer ramp** ($q = -5$ to $q = -2$): Rates rise from 0.011 to 0.013. Likely reflects sellers increasing activity or properties with rising tenant problems being selected into transfer.
3. **Pre-transfer dip** ($q = -1$): Sharp drop to 0.010 --- a 27\% decline from the $q = -2$ peak.
4. **Transfer quarter** ($q = 0$): Bottom at 0.006. The new owner has just taken possession.
5. **Post-transfer recovery** ($q = +1$ to $q = +3$): Rapid recovery from 0.008 to 0.012.
6. **New steady state** ($q = +4$ onward): Rates stabilize at 0.013--0.014, approximately 35\% above the pre-transfer baseline.

**The 1-unit vs multi-unit split** is informative: the pre-transfer dip is much deeper for single-unit buildings, consistent with vacancy during the sale process. Multi-unit buildings maintain relatively stable filing rates through the transition.

```{r raw-size-4way, fig.cap="Mean quarterly filing rate by building size (4-way split)."}
knitr::include_graphics(file.path(fig_dir, "rtt_eviction_quarterly_by_size_4way.png"))
```

# Specification

The baseline quarterly event study estimates:

$$
\text{FilingRate}_{it}^{(q)} = \sum_{k \neq -4} \beta_k \cdot \mathbf{1}[\text{q\_relative}_{it} = k] + \alpha_i + \gamma_{yq} + \varepsilon_{it}
$$

where $i$ indexes buildings (PIDs), $yq$ indexes calendar year-quarters, and $k \in \{-12, \ldots, -5, -3, \ldots, +20\}$ with $k = -4$ (one year before transfer) as the omitted reference period. We use $q = -4$ rather than $q = -1$ because the pre-transfer dip begins around $q = -1$, making it a poor reference point.

$\alpha_i$ are building fixed effects and $\gamma_{yq}$ are year-quarter fixed effects. Standard errors are clustered at the PID level.

**Unit-weighted specifications** weight each observation by `total_units`, so a 50-unit building contributes 50$\times$ the weight of a single-family home. This answers "what happens to the average *rental unit*" rather than "what happens to the average *building*."

# Baseline Regression Results

```{r baseline-plot, fig.cap="Quarterly event study coefficients (faceted). Eight specifications: full sample (weighted and unweighted), GEOID$\\times$yq FE, 5+ units (weighted and unweighted), known rentals 5+, 2+ units, and known rentals (all). Reference: q=-4."}
knitr::include_graphics(file.path(fig_dir, "rtt_eviction_quarterly_baseline.png"))
```

```{r baseline-table}
bl <- baseline_coefs[grepl("q_relative::", term)]
bl[, qr := as.integer(str_extract(term, "-?\\d+"))]
bl_key <- bl[qr %in% c(-8, -2, -1, 0, 1, 2, 4, 8),
             .(spec, qr, estimate = round(estimate, 5),
               std_error = round(std_error, 5))]
bl_key[, coef_str := paste0(
  formatC(estimate, format = "f", digits = 5),
  " (", formatC(std_error, format = "f", digits = 5), ")"
)]
bl_wide <- dcast(bl_key, qr ~ spec, value.var = "coef_str")
setorder(bl_wide, qr)
display_names <- names(bl_wide)
display_names[1] <- "q"
kable(bl_wide,
      col.names = display_names,
      caption = "Selected quarterly event study coefficients (SE in parentheses). Reference: q=-4.",
      align = c("r", rep("c", ncol(bl_wide) - 1))) |>
  kable_styling(latex_options = c("hold_position", "scale_down"), font_size = 8)
```

Key comparisons:

- **Unweighted vs unit-weighted**: Unit-weighting upweights large buildings. The weighted estimates answer "what happens to the average rental unit after a transfer?" while unweighted answers "what happens to the average building?"
- **GEOID $\times$ yq FE**: Adding block-group by year-quarter fixed effects produces nearly identical estimates, confirming the pattern is not driven by neighborhood trends.
- **5+ units**: The most relevant subsample --- these are established rental properties where the vacancy artifact is minimal.
- **2+ units**: Drops single-family homes (which dominate the full sample and have large vacancy artifacts) while retaining smaller multi-family properties.
- **Known rentals**: Restricts to properties with observed rental activity (license, filing, or InfoUSA match), removing owner-occupied buildings from the sample.

# Building Size Heterogeneity {#sec-size}

```{r size-plot, fig.cap="Quarterly event study by building size (4-way split, faceted). Separate regressions with PID + yq FE, clustered at PID."}
knitr::include_graphics(file.path(fig_dir, "rtt_eviction_quarterly_by_size.png"))
```

```{r size-table}
sz <- size_coefs[grepl("q_relative::", term)]
sz[, qr := as.integer(str_extract(term, "-?\\d+"))]
sz_key <- sz[qr %in% c(-8, -2, -1, 0, 1, 4, 8),
             .(spec, qr, estimate = round(estimate, 5))]
sz_wide <- dcast(sz_key, qr ~ spec, value.var = "estimate")
setorder(sz_wide, qr)
display_names <- names(sz_wide)
display_names[1] <- "q"
kable(sz_wide,
      col.names = display_names,
      digits = 5,
      caption = "Selected quarterly coefficients by building size. Reference: q=-4.",
      align = c("r", rep("c", ncol(sz_wide) - 1))) |>
  kable_styling(latex_options = c("hold_position", "scale_down"), font_size = 9)
```

**Key finding:** The pre-transfer dip is concentrated in small buildings. For 10+ unit buildings, filing rates are stable through the transition, confirming the dip is a vacancy artifact rather than an operational pattern.

# Buyer Type Heterogeneity (5+ Units) {#sec-buyer}

Buyer-type regressions are shown for both **5+ unit** and **2+ unit** buildings to avoid the single-family vacancy artifact.

```{r buyer-plot, fig.cap="Quarterly event study by buyer type (faceted). Corporate vs individual splits for 5+ and 2+ unit buildings. PID + yq FE, clustered at PID."}
knitr::include_graphics(file.path(fig_dir, "rtt_eviction_quarterly_by_buyer.png"))
```

```{r buyer-table}
by <- buyer_coefs[grepl("q_relative::", term)]
by[, qr := as.integer(str_extract(term, "-?\\d+"))]
by_key <- by[qr %in% c(-8, -2, -1, 0, 1, 2, 4, 8, 12),
             .(spec, qr, estimate = round(estimate, 5),
               std_error = round(std_error, 5))]
by_key[, coef_str := paste0(
  formatC(estimate, format = "f", digits = 5),
  " (", formatC(std_error, format = "f", digits = 5), ")"
)]
by_wide <- dcast(by_key, qr ~ spec, value.var = "coef_str")
setorder(by_wide, qr)
display_names <- names(by_wide)
display_names[1] <- "q"
kable(by_wide,
      col.names = display_names,
      caption = "Quarterly event study by buyer type, 5+ units (SE in parentheses). Reference: q=-4.",
      align = c("r", rep("c", ncol(by_wide) - 1))) |>
  kable_styling(latex_options = c("hold_position"))
```

# Acquirer Filing Rate Heterogeneity {#sec-acq}

We classify acquirers by their **pre-acquisition temporal filing rate** on their other properties. For each transfer of PID $i$ by owner $j$ (transfer year $Y$), we compute the mean `num_filings / total_units` across all *other* PIDs that owner $j$ acquired, using only years strictly before $Y$. This avoids both mechanical circularity and any look-ahead bias.

**Definitions:**

- **High-filer portfolio**: Pre-acquisition rate $>$ `r round(med_acq, 4)` (the median among acquirers with rate $> 0$), and the owner acquired at least one other property
- **Low-filer portfolio**: $0 <$ rate $\leq$ `r round(med_acq, 4)`, has other properties
- **Non-filer (has portfolio)**: Rate $= 0$ but has other properties (no pre-acquisition filings observed)
- **Single-purchase**: No other matched properties (first buy or unmatched)

```{r acq-stats-table}
acq_2plus <- acq_stats[sample == "2plus"]
kable(acq_2plus[, .(acq_filer_bin, n_transfers, n_pids, n_owners,
                    total_units_sum, mean_acq_rate, mean_n_other,
                    pct_of_transfers, pct_of_units)],
      col.names = c("Acquirer type", "Transfers", "PIDs", "Owners",
                     "Total units", "Mean acq rate", "Mean n other",
                     "% transfers", "% units"),
      digits = c(0, 0, 0, 0, 0, 4, 1, 1, 1),
      format.args = list(big.mark = ","),
      caption = "Acquirer classification (2+ unit buildings, at q=0). Rate = mean pre-acquisition filing rate on acquirer's OTHER properties.") |>
  kable_styling(latex_options = c("hold_position", "scale_down"), font_size = 9)
```

## 2+ unit buildings

```{r acq-plot, fig.cap="Quarterly event study by acquirer pre-acquisition filing rate (2+ unit buildings). High-filer portfolio acquirers show the largest post-transfer increase."}
knitr::include_graphics(file.path(fig_dir, "rtt_eviction_quarterly_by_acq_filer.png"))
```

```{r acq-table, eval=nrow(acq_coefs) > 0}
ac <- acq_coefs[grepl("q_relative::", term)]
ac[, qr := as.integer(str_extract(term, "-?\\d+"))]
ac_key <- ac[qr %in% c(-8, -2, -1, 0, 1, 2, 4, 8),
             .(spec, qr, estimate = round(estimate, 5),
               std_error = round(std_error, 5))]
ac_key[, coef_str := paste0(
  formatC(estimate, format = "f", digits = 5),
  " (", formatC(std_error, format = "f", digits = 5), ")"
)]
ac_wide <- dcast(ac_key, qr ~ spec, value.var = "coef_str")
setorder(ac_wide, qr)
display_names <- names(ac_wide)
display_names[1] <- "q"
kable(ac_wide,
      col.names = display_names,
      caption = "Quarterly event study by acquirer filing rate, 2+ unit buildings (SE in parentheses). Reference: q=-4.",
      align = c("r", rep("c", ncol(ac_wide) - 1))) |>
  kable_styling(latex_options = c("hold_position", "scale_down"), font_size = 9)
```

## 5+ unit buildings

```{r acq-5plus-stats}
acq_5plus <- acq_stats[sample == "5plus"]
if (nrow(acq_5plus) > 0) {
  kable(acq_5plus[, .(acq_filer_bin, n_transfers, n_pids, n_owners,
                       total_units_sum, mean_acq_rate, mean_n_other,
                       pct_of_transfers, pct_of_units)],
        col.names = c("Acquirer type", "Transfers", "PIDs", "Owners",
                       "Total units", "Mean acq rate", "Mean n other",
                       "% transfers", "% units"),
        digits = c(0, 0, 0, 0, 0, 4, 1, 1, 1),
        format.args = list(big.mark = ","),
        caption = "Acquirer classification (5+ unit buildings, at q=0).") |>
    kable_styling(latex_options = c("hold_position", "scale_down"), font_size = 9)
}
```

```{r acq-5plus-plot, fig.cap="Quarterly event study by acquirer filing behavior, 5+ unit buildings only."}
f5 <- file.path(fig_dir, "rtt_eviction_quarterly_by_acq_filer_5plus.png")
if (file.exists(f5)) knitr::include_graphics(f5)
```

Key findings:

- **Single-purchase acquirers** (`r acq_desc[acq_filer_bin == "Single-purchase", pct_of_transfers]`\% of transfers, `r format(acq_desc[acq_filer_bin == "Single-purchase", n_owners], big.mark = ",")` unique owners): These have no other matched properties. They are largely individual buyers (`r round(100 - acq_desc[acq_filer_bin == "Single-purchase", pct_corporate], 1)`\% non-corporate) with median price \$`r format(acq_desc[acq_filer_bin == "Single-purchase", median_price], big.mark = ",")`.
- **Low-filer portfolio** (`r acq_desc[acq_filer_bin == "Low-filer portfolio", pct_of_transfers]`\%, `r format(acq_desc[acq_filer_bin == "Low-filer portfolio", n_owners], big.mark = ",")` owners): Mean portfolio `r round(acq_desc[acq_filer_bin == "Low-filer portfolio", mean_portfolio], 1)` properties, `r acq_desc[acq_filer_bin == "Low-filer portfolio", pct_corporate]`\% corporate, pre-acq rate `r round(acq_desc[acq_filer_bin == "Low-filer portfolio", mean_acq_rate], 4)`.
- **High-filer portfolio** (`r acq_desc[acq_filer_bin == "High-filer portfolio", pct_of_transfers]`\%, `r format(acq_desc[acq_filer_bin == "High-filer portfolio", n_owners], big.mark = ",")` owners): Mean portfolio `r round(acq_desc[acq_filer_bin == "High-filer portfolio", mean_portfolio], 1)` properties, `r acq_desc[acq_filer_bin == "High-filer portfolio", pct_corporate]`\% corporate, pre-acq rate `r round(acq_desc[acq_filer_bin == "High-filer portfolio", mean_acq_rate], 4)`.

# Portfolio Size Heterogeneity {#sec-portfolio}

Portfolio bins are based on the total number of **non-sheriff** acquisitions by the buyer entity.

## 2+ unit buildings

```{r port-stats-table}
port_2plus <- port_stats[sample == "2plus"]
kable(port_2plus[, .(portfolio_bin, n_transfers, n_owners,
                     total_units_sum, pct_corp, mean_units)],
      col.names = c("Portfolio bin", "Transfers", "Owners",
                     "Total units", "% corp", "Mean units"),
      digits = c(0, 0, 0, 0, 1, 1),
      format.args = list(big.mark = ","),
      caption = "Portfolio size bin descriptives, 2+ unit buildings (at q=0). Bins based on non-sheriff acquisition count.") |>
  kable_styling(latex_options = c("hold_position"))
```

```{r portfolio-plot, fig.cap="Quarterly event study by portfolio size, 2+ unit buildings."}
knitr::include_graphics(file.path(fig_dir, "rtt_eviction_quarterly_by_portfolio.png"))
```

```{r portfolio-table, eval=nrow(port_coefs) > 0}
pt <- port_coefs[grepl("q_relative::", term)]
pt[, qr := as.integer(str_extract(term, "-?\\d+"))]
pt_key <- pt[qr %in% c(-8, -2, -1, 0, 1, 2, 4, 8),
             .(spec, qr, estimate = round(estimate, 5))]
pt_wide <- dcast(pt_key, qr ~ spec, value.var = "estimate")
setorder(pt_wide, qr)
display_names <- names(pt_wide)
display_names[1] <- "q"
kable(pt_wide,
      col.names = display_names,
      digits = 5,
      caption = "Quarterly event study by portfolio size, 2+ unit buildings. Reference: q=-4.",
      align = c("r", rep("c", ncol(pt_wide) - 1))) |>
  kable_styling(latex_options = c("hold_position", "scale_down"), font_size = 9)
```

## 5+ unit buildings

```{r port-5plus-stats}
port_5plus <- port_stats[sample == "5plus"]
if (nrow(port_5plus) > 0) {
  kable(port_5plus[, .(portfolio_bin, n_transfers, n_owners,
                        total_units_sum, pct_corp, mean_units)],
        col.names = c("Portfolio bin", "Transfers", "Owners",
                       "Total units", "% corp", "Mean units"),
        digits = c(0, 0, 0, 0, 1, 1),
        format.args = list(big.mark = ","),
        caption = "Portfolio size bin descriptives, 5+ unit buildings (at q=0).") |>
    kable_styling(latex_options = c("hold_position"))
}
```

```{r portfolio-5plus-plot, fig.cap="Quarterly event study by portfolio size, 5+ unit buildings only."}
f5p <- file.path(fig_dir, "rtt_eviction_quarterly_by_portfolio_5plus.png")
if (file.exists(f5p)) knitr::include_graphics(f5p)
```

# Transfer Pattern Descriptives {#sec-descriptives}

## Do high-evicting properties transfer more often?

We classify properties by their **pre-transfer filing intensity** using `filing_rate_eb_pre_covid` from the building panel --- the empirical Bayes smoothed annual filing rate per unit, computed from pre-COVID data.

**Definitions:**

- **Above-median filing**: `filing_rate_eb_pre_covid` $>$ `r round(med_prop, 4)` (the median among properties with any filings)
- **Below-median filing**: `filing_rate_eb_pre_covid` $> 0$ and $\leq$ `r round(med_prop, 4)`
- **Zero-filing**: `filing_rate_eb_pre_covid` $= 0$

```{r transfer-rate}
kable(transfer_rate[property_evict_class != "No data"],
      col.names = c("Property class", "N properties", "N transferred",
                     "% transferred", "Mean units", "Total units"),
      digits = c(0, 0, 0, 1, 1, 0),
      format.args = list(big.mark = ","),
      caption = "Transfer rate by property eviction class (universe: all PIDs in bldg\\_panel\\_blp, 2010--2019).") |>
  kable_styling(latex_options = c("hold_position"))
```

High-evicting properties transfer at similar rates to low-evicting ones --- approximately 80\% of properties in both categories experienced at least one transfer during the sample period. The relevant question is not *whether* these properties transfer, but *who buys them*.

## Who buys high-evicting properties?

```{r buyer-by-class}
kable(buyer_by_class,
      col.names = c("Property class", "Transfers", "PIDs",
                     "% corp", "Mean portfolio", "Median price",
                     "Mean units", "Total units", "% sheriff"),
      digits = c(0, 0, 0, 1, 1, 0, 1, 0, 1),
      format.args = list(big.mark = ","),
      caption = "Buyer characteristics by property eviction class. Above-median properties attract buyers with larger portfolios and slightly higher corporate share.") |>
  kable_styling(latex_options = c("hold_position", "scale_down"), font_size = 9)
```

Above-median evicting properties attract slightly more corporate buyers (`r buyer_by_class[property_evict_class == "Above-median filing", pct_corporate]`\% vs `r buyer_by_class[property_evict_class == "Below-median filing", pct_corporate]`\%) and buyers with somewhat larger portfolios (mean `r buyer_by_class[property_evict_class == "Above-median filing", mean_portfolio]` vs `r buyer_by_class[property_evict_class == "Below-median filing", mean_portfolio]` properties).

## How often do high-evicting landlords buy?

```{r acq-desc-table}
kable(acq_desc[, .(acq_filer_bin, n_transfers, pct_of_transfers, n_owners,
                    total_units, pct_of_units, pct_corporate, mean_portfolio)],
      col.names = c("Acquirer type", "Transfers", "% of transfers",
                     "Unique owners", "Total units", "% of units",
                     "% corp", "Mean portfolio"),
      digits = c(0, 0, 1, 0, 0, 1, 1, 1),
      format.args = list(big.mark = ","),
      caption = "Acquirer filing rate descriptives. Single-purchase acquirers dominate (69\\% of transfers) but portfolio acquirers control a disproportionate share of units.") |>
  kable_styling(latex_options = c("hold_position", "scale_down"), font_size = 9)
```

**Single-purchase acquirers** account for `r acq_desc[acq_filer_bin == "Single-purchase", pct_of_transfers]`\% of all transfers and `r acq_desc[acq_filer_bin == "Single-purchase", pct_of_units]`\% of units. **High-filer portfolio acquirers** are `r acq_desc[acq_filer_bin == "High-filer portfolio", pct_of_transfers]`\% of transfers and `r acq_desc[acq_filer_bin == "High-filer portfolio", pct_of_units]`\% of units. They are predominantly corporate (`r acq_desc[acq_filer_bin == "High-filer portfolio", pct_corporate]`\% corporate) with large portfolios (mean `r round(acq_desc[acq_filer_bin == "High-filer portfolio", mean_portfolio], 1)` properties).

**Low-filer portfolio acquirers** are the most concentrated group: only `r format(acq_desc[acq_filer_bin == "Low-filer portfolio", n_owners], big.mark = ",")` unique owners account for `r acq_desc[acq_filer_bin == "Low-filer portfolio", pct_of_transfers]`\% of transfers. These are large-portfolio corporate operators (mean `r round(acq_desc[acq_filer_bin == "Low-filer portfolio", mean_portfolio], 1)` properties, `r acq_desc[acq_filer_bin == "Low-filer portfolio", pct_corporate]`\% corporate).

## Cross-tab: property eviction class $\times$ acquirer type

```{r cross-tab}
ct_display <- cross_tab[, .(property_evict_class, acq_filer_bin,
                             n_transfers, total_units, pct_of_class)]
kable(ct_display,
      col.names = c("Property class", "Acquirer type",
                     "Transfers", "Total units", "% of class"),
      digits = c(0, 0, 0, 0, 1),
      format.args = list(big.mark = ","),
      caption = "Who buys which properties? Cross-tab of property eviction class by acquirer type.") |>
  kable_styling(latex_options = c("hold_position"))
```

The cross-tab reveals **sorting**: high-filer portfolio acquirers account for `r cross_tab[property_evict_class == "Above-median filing" & acq_filer_bin == "High-filer portfolio", pct_of_class]`\% of above-median property transfers but only `r cross_tab[property_evict_class == "Below-median filing" & acq_filer_bin == "High-filer portfolio", pct_of_class]`\% of below-median ones. Conversely, single-purchase acquirers dominate below-median properties (`r cross_tab[property_evict_class == "Below-median filing" & acq_filer_bin == "Single-purchase", pct_of_class]`\%) more than above-median ones (`r cross_tab[property_evict_class == "Above-median filing" & acq_filer_bin == "Single-purchase", pct_of_class]`\%).

# Summary

The quarterly event study resolves the pre-trend puzzle from the annual analysis and provides rich heterogeneity:

1. **The annual $t=-1$ artifact is explained.** Filing rates peak at $q = -2$, then drop sharply at $q = -1$ and bottom at $q = 0$.

2. **The pre-transfer dip is a small-building vacancy effect.** For 10+ unit buildings, filing rates are stable through the transition.

3. **The post-transfer increase is real and operational.** It appears across building sizes and is larger for corporate buyers (among 5+ unit buildings).

4. **High-filer portfolio acquirers drive the effect.** The `r acq_desc[acq_filer_bin == "High-filer portfolio", pct_of_transfers]`\% of transfers going to high-filer portfolios show the largest post-transfer filing increases; single-purchase acquirers show smaller or no increases.

5. **Sorting exists.** High-filer acquirers disproportionately buy already-high-evicting properties, consistent with a market for high-eviction buildings.
